---
sidebar: sidebar 
permalink: task_create_monitor.html 
keywords: performance policy, performance, thresholds, alerts, preference, delete 
summary: パフォーマンスまたはインベントリのしきい値をアラートするためのモニタを作成する 
---
= モニタとのアラート


[role="lead"]
監視を作成して、ネットワーク内のリソースに関連する問題についてユーザに通知するアラートをトリガーするしきい値を設定します。たとえば、多数のプロトコルのいずれかに対して _node write latency _ に対してアラートを送信するモニタを作成できます。


TIP: モニタとアラートは、 Cloud Insights Standard Edition 以降で使用できます。

監視対象のしきい値と条件に達したとき、またはしきい値を超えたときに、 Cloud Insights はアラートを作成します。モニタには、 _Warning_threshold 、 a_Critical_threshold 、またはその両方を指定できます。



=== 監視とパフォーマンスポリシー

パフォーマンスポリシー * と * モニター * の違いは何ですか？

_Policies _ では、ストレージ、 VM 、 EC2 、ポートなどの「インフラ」オブジェクトにしきい値を設定できます。これらのポリシーは、しきい値に達したときや超えたときに違反をトリガーします。トラブルシューティングについては、違反ごとに調査できます。ポリシーの詳細については、このセクションの他の部分で説明します link:task_create_performance_policies.html["ドキュメント"]。

_ モニタ _ は、 Kubernetes 、 ONTAP 高度なメトリックス、 Telegraf プラグイン用に収集されたデータや、しきい値を超えたときにアラートを生成するデータなど、「統合」データに類似した機能を提供します。モニタでは、警告レベルまたは重大レベルのアラートのしきい値、またはその両方を設定できます。

ポリシーとモニターは、 * 警告 * メニューで使用できます。

image:AlertsMenuLarger.png["アラートメニュー"]

ポリシーまたはモニタがトリガされたときに電子メールを送信できます。



=== モニタの作成

次の例では、 _Volume Node NFS Write Latency _reaches or exceeds 200ms 、および 400ms に達したか超えると Critical アラートを通知する監視を作成します。いずれかのしきい値を 15 分以上連続して超えた場合にのみ、アラートを表示する必要があります。



==== 要件

* 統合データを収集し、そのデータを収集するように Cloud Insights を設定する必要があります。




==== モニタを作成します

. Cloud Insights メニューで、 * Alerts > Manage Monitors * をクリックします
+
[ モニタ ] リストページが表示され、現在設定されているモニタが表示されます。

. モニタを追加するには、 *+ モニタ * をクリックします。既存のモニタを変更するには、リストでモニタ名をクリックします。
+
Monitor Configuration （モニタ設定）ダイアログが表示されます。

. ドロップダウンで、監視するオブジェクトのタイプと指標を検索して選択します。例： _NetApp_ONTAP_volume_node_name _nfs_write_latency _ 。


フィルタを設定して、監視するオブジェクトの属性や指標を絞り込むことができます。

image:MonitorMetricFilter.png["メトリックフィルタリング"]

統合データ（ Kubernetes 、 ONTAP 高度なデータなど）を使用する場合、指標フィルタリングを使用すると、データ系列の集計値でフィルタが機能し、グラフからオブジェクト全体が削除されるのとは異なり、プロットされたデータ系列から個々のデータポイントや一致しないデータポイントが削除されます。


TIP: 複数条件のモニタ（ IOPS > X 、レイテンシ > Y など）を作成するには、最初の条件をしきい値、 2 番目の条件をフィルタとして定義します。



==== モニターの条件を定義します。

. 監視するオブジェクトと指標を選択したら、警告レベルと重大レベルのしきい値、またはその両方を設定します。
. _Warning_level には、 200 を入力します。この警告レベルを示す破線がグラフの例に表示されます。
. _Critical_level の場合は、 400 と入力します。このクリティカルレベルを示す破線がグラフの例に表示されます。
+
このグラフには履歴データが表示されます。グラフ上の警告および重大レベルの線はモニタを視覚的に表しているため、モニタがアラートをトリガーするタイミングを簡単に確認できます。

. 実行間隔には、 _15 分 _ の間で _Continuously_ を選択します。
+
しきい値を超えた時点でアラートをトリガーするか、しきい値が一定期間継続して違反になるまでアラートをトリガーするかを選択できます。この例では、合計 IOPS が警告レベルまたは重大レベルを超えるたびにアラートを表示する必要はありませんが、監視対象のオブジェクトがこれらのレベルの 1 つを 15 分以上継続して超えた場合にのみアラートを表示します。

+
image:define_monitor_conditions.png["条件を定義します"]





=== 対処方法または追加情報を設定しています

オプションの概要を追加したり、追加のインサイトや修正アクションを追加したりするには、「 * アラート概要の追加 * 」セクションに入力します。概要は 1024 文字以内で指定し、アラートとともに送信されます。分析情報 / 対処方法のフィールドは最大 67,000 文字で、アラートランディングページの概要セクションに表示されます。

これらのフィールドには、アラートを修正したり対処したりするためのメモ、リンク、手順を入力できます。

image:Monitors_Alert_Description.png["アラートの対処方法と概要"]



=== 通知タイプと受信者を選択します

[ チーム通知の設定 ] セクションでは、電子メールと Webhook のどちらでチームに通知するかを選択できます。

image:Webhook_Choose_Monitor_Notification.png["アラート方法を選択します"]

* 電子メールによる警告 :*

アラート通知の E メール受信者を指定します。必要に応じて、警告または重大なアラートの受信者を別々に選択することもできます。

image:email_monitor_alerts.png["E メールアラートの受信者"]

* Webhook による警告 :*

アラート通知に使用する Web フックを指定します。必要に応じて、警告または重大なアラートに別のフックを選択できます。

image:Webhook_Monitor_Notifications.png["Webhook Alerting ( ウェブフック警告"]


NOTE: Webhook はプレビュー機能と見なされるため、変更される場合があります。



=== モニタを保存します

. 必要に応じて、モニタの概要を追加できます。
. モニターにわかりやすい名前を付け、 * 保存 * をクリックします。
+
新しいモニタがアクティブなモニタのリストに追加されます。





=== 監視リスト

[Monitor] ページには、現在設定されているモニタが一覧表示され、次の情報が示されます

* モニタ名
* ステータス
* 監視対象のオブジェクト / 指標
* モニタの状態


モニターの右側にあるメニューをクリックし、 * 一時停止 * を選択すると、オブジェクトタイプの監視を一時的に停止できます。モニタリングを再開する準備ができたら、 * Resume * （続行）をクリックします。

モニタをコピーするには、メニューから「 * Duplicate （複製） * 」を選択します。その後、新しいモニタを変更して、オブジェクト / 指標、フィルタ、条件、 E メール受信者などを変更できます

モニタが不要になった場合は、メニューから * Delete * を選択して削除できます。



== グループとシステム定義モニタを監視します

グループ化により、関連するモニタを表示および管理できます。たとえば、環境内のストレージ専用の監視グループを使用したり、特定の受信者リストに関連する監視を使用したりできます。

image:Monitors_Custom_System.png["モニタグループリスト"]

モニタは、次のカテゴリに分類されます。

* * すべてのモニター * ：ユーザー作成とシステム定義の両方のすべてのモニター
* * カスタムモニター * ：ユーザーが作成したモニターが含まれます
* *System Monitor グループ *: これらのグループには、システム定義モニタが含まれています。これらのモニタは、ご使用の環境内のデータコレクタに基づいています
* * ユーザ作成モニタグループ *: これらは作成したモニタグループです


グループ名の横には、グループに含まれるモニタの数が表示されます。


NOTE: カスタムモニタは、一時停止、再開、削除、または別のグループへの移動が可能です。システム定義のモニタは一時停止および再開できますが、削除または移動することはできません。



=== システム定義のモニター

システム定義のモニタは、事前に定義されたメトリックと条件に加えて、デフォルトの説明と修正アクションで構成されています。これらは変更できません。システム定義モニタの通知受信者リストを変更できます。メトリック、条件、概要、および修正アクションを表示したり、受信者リストを変更したりするには、システム定義のモニタグループを開き、リスト内のモニタ名をクリックします。

システム定義のモニタグループは変更または削除できません。

以下のシステム定義モニタは、記載されたグループで使用できます。

* * ONTAP インフラストラクチャ * は、 ONTAP クラスタのインフラストラクチャ関連の問題を監視します。
* * ONTAP ワークロードの例 * には、ワークロード関連の問題のモニターが含まれています。
* 両方のグループのモニタのデフォルトは _Paused _ state です。


|===
| グループ | モニタ名 | 概要を監視します 


| ONTAP インフラ | ストレージ容量の制限 | ストレージプール（アグリゲート）がいっぱいになると、 I/O 処理が低速化し、最後にストレージ停止インシデントの原因となって I/O 処理が停止します。警告アラートは、最小限の空きスペースをリストアするために計画的な対処が必要であることを示しています。重大アラートは、サービスの停止が差し迫っていることを示しており、サービスの継続性を確保するためにスペースを解放するために緊急措置を講じる必要があることを示しています。 


| ONTAP インフラ | ストレージパフォーマンスの制限 | ストレージプールのパフォーマンスが上限に達すると、処理速度が低下し、レイテンシが増大してワークロードやアプリケーションが停止する可能性があります。ONTAP は、ワークロードに起因するストレージプール利用率を評価して、パフォーマンスの消費率を推定します。警告アラートは、ワークロードのピークに対応できるだけの十分なストレージプールのパフォーマンスがなくなる可能性があるため、ストレージプールの負荷を軽減するために計画的なアクションを実行する必要があることを示しています。重大アラートは ' パフォーマンス低下が差し迫っていることを示し ' サービスの継続性を確保するためにストレージ・プールの負荷を軽減するために緊急措置を講じる必要があることを示します 


| ONTAP インフラ | ファイバチャネルポートの高利用率 | ファイバチャネルプロトコルポートは、お客様のホストシステムと ONTAP LUN の間で SAN トラフィックを送受信するために使用されます。ポート利用率が高いとボトルネックになり、最終的にファイバチャネルプロトコルのワークロードのパフォーマンスに影響します。警告アラートは、ネットワークトラフィックを分散するために計画的なアクションを実行する必要があることを示します。重大アラートは、サービスの中断が差し迫っていることを示しており、サービスの継続性を確保するために、ネットワークトラフィックのバランスを取るために緊急措置を講じる必要があることを示しています。 


| ONTAP インフラ | ネットワークポートの高利用率 | ネットワークポートは、 NFS 、 CIFS 、および iSCSI のプロトコルトラフィックを受信して、お客様のホストシステムと ONTAP の間で転送するために使用されます。ポート利用率が高いとボトルネックになり、最終的には NFS 、 CIFS 、および iSCSI のワークロードのパフォーマンスに影響します。警告アラートは、ネットワークトラフィックを分散するために計画的なアクションを実行する必要があることを示します。重大アラートは、サービスの中断が差し迫っていることを示しており、サービスの継続性を確保するために、ネットワークトラフィックのバランスを取るために緊急措置を講じる必要があることを示しています。 


| ONTAP ワークロードの例 | ボリュームの inode 制限 | ファイルを格納するボリュームでは、インデックスノード（ inode ）を使用してファイルメタデータが格納されます。ボリュームが inode の割り当てを使用しなくなると、そのボリュームにはこれ以上ファイルを追加できません。警告アラートは、使用可能な inode の数を増やすために計画的な処理が必要であることを示しています。重大アラートは、ファイル制限の枯渇が差し迫っていることを示し、サービスの継続性を確保するために inode を解放するための緊急対策を講じる必要があることを示しています。 


| ONTAP ワークロードの例 | qtree 容量がフルです | qtree とは、論理的に定義されたファイルシステムで、ボリューム内のルートディレクトリに特別なサブディレクトリとして作成できます。各 qtree には、ボリュームの容量内でツリーに格納されるデータの量を制限するために、クォータポリシーによって定義されるデフォルトのスペースクォータまたはクォータがあります。警告アラートは、スペースを増やすために計画的な対処が必要であることを示します。重大アラートは、サービスの停止が差し迫っていることを示しており、サービスの継続性を確保するためにスペースを解放するために緊急措置を講じる必要があることを示しています。 


| ONTAP ワークロードの例 | LUN の高レイテンシ | LUN は、 I/O トラフィックを処理するオブジェクトで、データベースなどのパフォーマンス重視のアプリケーションによって頻繁に駆動されます。LUN のレイテンシが高いと、アプリケーション自体に影響を及ぼし、タスクを実行できなくなる可能性があります。警告アラートは、 LUN を適切なノードまたはアグリゲートに移動するための計画的なアクションが必要であることを示しています。重大アラートは、サービスの停止が差し迫っていることを示しており、サービスの継続性を確保するために緊急措置を講じる必要があることを示しています。メディアタイプに基づく想定レイテンシは、最大 1 ～ 2 ミリ秒、 SAS は最大 8 ～ 10 ミリ秒、 SATA HDD は 17 ～ 20 ミリ秒です 


| ONTAP ワークロードの例 | NVMe ネームスペースの高レイテンシ | NVMe ネームスペースは、 I/O トラフィックを処理するオブジェクトで、多くの場合、データベースなどのパフォーマンス重視のアプリケーションによって駆動されます。NVMe ネームスペースのレイテンシが高いと、アプリケーション自体が影響を受け、タスクを実行できなくなる可能性があります。警告アラートは、 LUN を適切なノードまたはアグリゲートに移動するための計画的なアクションが必要であることを示しています。重大アラートは、サービスの停止が差し迫っていることを示しており、サービスの継続性を確保するために緊急措置を講じる必要があることを示しています。 


| ONTAP ワークロードの例 | qtree のファイル数がソフトリミット | qtree とは、論理的に定義されたファイルシステムで、ボリューム内のルートディレクトリに特別なサブディレクトリとして作成できます。各 qtree には、ボリューム内の管理可能なファイルシステムサイズを維持するために、格納可能なファイル数のクォータがあります。qtree では、ソフトファイル番号クォータが維持されます。これにより、 qtree 内のファイル数の上限に達する前にユーザにプロアクティブにアラートを送信し、追加のファイルを格納できなくなります。qtree 内のファイル数を監視すると、ユーザには中断のないデータサービスが確実に提供されます。 


| ONTAP ワークロードの例 | qtree のファイル数のハードリミット | qtree とは、論理的に定義されたファイルシステムで、ボリューム内のルートディレクトリに特別なサブディレクトリとして作成できます。各 qtree には、ボリューム内の管理可能なファイルシステムサイズを維持するために、格納可能なファイル数のクォータがあります。qtree は、ハードファイル番号のクォータを維持します。このクォータを超えると、ツリー内の新しいファイルは拒否されます。qtree 内のファイル数を監視すると、ユーザには中断のないデータサービスが確実に提供されます。 


| ONTAP ワークロードの例 | qtree 容量のソフトリミット | qtree とは、論理的に定義されたファイルシステムで、ボリューム内のルートディレクトリに特別なサブディレクトリとして作成できます。各 qtree には、ボリューム内のユーザデータの増加を制御し、合計容量を超えないようにするために、データの格納に使用できる容量クォータ（ KB ）が設定されています。qtree は、ストレージのソフト容量クォータを維持します。これにより、 qtree の合計容量クォータ制限に達する前にユーザにプロアクティブにアラートを送信し、データを格納できなくなります。qtree に格納されているデータ量を監視することで、ユーザに中断のないデータサービスを確実に提供できます。 


| ONTAP ワークロードの例 | qtree 容量ハードリミット | qtree とは、論理的に定義されたファイルシステムで、ボリューム内のルートディレクトリに特別なサブディレクトリとして作成できます。各 qtree には、ボリューム内のユーザデータの増加を制御し、合計容量を超えないようにするために、データの格納に使用できる容量クォータ（ KB ）が設定されています。qtree ハードストレージ容量クォータは、 qtree への書き込みが拒否されるしきい値として機能します。qtree に格納されているデータ量を監視することで、ユーザに中断のないデータサービスを確実に提供できます。 


| ONTAP ワークロードの例 | ユーザクォータ容量のソフトリミット | ONTAP は、ボリューム内のボリューム、ファイル、またはディレクトリにアクセスできる権限を持つ UNIX または Windows システムのユーザを認識します。その結果、ユーザやユーザグループが使用する Linux または Windows システムのストレージ容量を ONTAP で設定できるようになります。ユーザまたはグループのポリシークォータによって、ユーザが自身のデータに使用できるスペース量が制限されます。このクォータのソフトリミットを使用すると、ボリュームの使用済み容量が合計容量クォータに達したときにユーザにプロアクティブに通知できます。ユーザクォータまたはグループクォータに保存されているデータ量を監視することで、ユーザに中断のないデータサービスを確実に提供できます。 


| ONTAP ワークロードの例 | ユーザクォータ容量のハードリミット | ONTAP は、ボリューム内のボリューム、ファイル、またはディレクトリにアクセスできる権限を持つ UNIX または Windows システムのユーザを認識します。その結果、ユーザやユーザグループが使用する Linux または Windows システムのストレージ容量を ONTAP で設定できるようになります。ユーザまたはグループのポリシークォータによって、ユーザが自身のデータに使用できるスペース量が制限されます。このクォータのハードリミットによって、ボリューム内の使用済み容量が合計容量クォータに達する直前にユーザに通知できます。ユーザクォータまたはグループクォータに保存されているデータ量を監視することで、ユーザに中断のないデータサービスを確実に提供できます。 


| ONTAP ワークロードの例 | ボリュームの高レイテンシ | ボリュームとは、多くの場合、 DevOps アプリケーション、ホームディレクトリ、データベースなどのパフォーマンス重視のアプリケーションによって I/O トラフィックを処理するオブジェクトです。ボリュームのレイテンシが高いと、アプリケーション自体に影響を及ぼし、タスクを実行できなくなる可能性があります。ボリュームのレイテンシを監視することは、アプリケーションの整合性を維持するうえで非常に重要です。メディアタイプに基づく想定レイテンシは、最大 1 ～ 2 ミリ秒、 SAS は最大 8 ～ 10 ミリ秒、 SATA HDD は 17 ～ 20 ミリ秒です 


| ONTAP ワークロードの例 | Snapshot リザーブ容量がフルです | アプリケーションとお客様のデータを格納するには、ボリュームのストレージ容量が必要です。スナップショット予約領域と呼ばれる領域の一部はスナップショットの保存に使用され、データをローカルで保護できます。ONTAP ボリュームに格納される新規データや更新データが多いほど、使用される Snapshot 容量は増えますが、今後追加または更新されるデータに使用できる Snapshot ストレージ容量は少なくなります。ボリューム内の Snapshot データ容量が Snapshot リザーブの合計スペースに達すると、新しい Snapshot データを格納できなくなり、ボリューム内のデータの保護レベルが低下する可能性があります。ボリュームの使用済み Snapshot 容量を監視して、データサービスの継続性を確保します。 


| ONTAP ワークロードの例 | ボリューム容量がフルです | アプリケーションとお客様のデータを格納するには、ボリュームのストレージ容量が必要です。ONTAP ボリュームに格納されるデータが多いほど、以降のデータで使用できるストレージ容量は少なくなります。ボリューム内のデータストレージ容量が合計ストレージ容量に達すると、ストレージ容量の不足によりデータを格納できなくなる可能性があります。ボリュームの使用済みストレージ容量を監視して、データサービスの継続性を確保します。 
|===


=== カスタムモニタグループ

新しいカスタムモニタグループを作成するには、「 + 」「新規モニタグループの作成 * 」ボタンをクリックします。グループの名前を入力し、 * グループの作成 * をクリックします。空のグループがその名前で作成されます。

モニタをグループに追加するには、 _all Monitors グループ（推奨）に移動し、次のいずれかの操作を行います。

* 単一のモニタを追加するには、モニタの右側にあるメニューをクリックし、 _ グループに追加 _ を選択します。モニタを追加するグループを選択します。
* モニタ名をクリックしてモニタの編集ビューを開き '_Associate to a monitor group_ セクションでグループを選択します
+
image:Monitors_AssociateToGroup.png["グループに関連付けます"]



モニタを削除するには、グループをクリックし、メニューから「 _ グループから削除」を選択します。モニタを _all Monitors _ または _Custom Monitors _ グループから削除することはできませんこれらのグループからモニタを削除するには、モニタ自体を削除する必要があります。


NOTE: グループからモニタを削除しても、モニタは Cloud Insights から削除されません。モニタを完全に削除するには、モニタを選択し、 _Delete_( 削除 ) をクリックします。これにより、その所有者であるグループからも削除され、どのユーザからも使用できなくなります。

同様にモニタを別のグループに移動するには '_Move to Group_ を選択します


NOTE: 各モニタは、一度に 1 つのグループにしか所属できません。

グループ内のすべてのモニタを一度に一時停止または再開するには、グループのメニューを選択し、 _Pause_or_Resume_を クリックします。

同じメニューを使用して、グループの名前変更または削除を行います。グループを削除しても、 Cloud Insights からモニタは削除されません。これらのモニタは、 _ALL Monitors で使用できます。

image:Monitors_PauseGroup.png["グループを一時停止します"]



=== 詳細情報

* link:task_view_and_manage_alerts.html["アラートの表示と非表示"]

